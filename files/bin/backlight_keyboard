#!/bin/bash

path="/sys/class/leds/asus::kbd_backlight"
# alternative interface (0 < x < 10)
#path="/sys/class/backlight/acpi_video0/"

# max should be 3
max=$(cat ${path}/max_brightness)

step=$((1))
# for a value smaller than treshold, the steps are smaller for a more accurate setting at low intensity
treshold=$((2*$step))
previous=$(cat ${path}/brightness)

function commit {
	if [[ $1 = [0-9]* ]]
	then 
		if [[ $1 -gt $max ]]
		then 
			next=$max
		elif [[ $1 -lt 0 ]]
		then 
			next=0
		else 
			next=$1
		fi
		echo $next >> ${path}/brightness
		exit 0
	else 
		exit 1
	fi
}

case "$1" in
	up)
		commit $(($previous + 1))
		;;
	down)
		commit $(($previous - 1))
		;;
	max)
		commit $max
		;;
	show)
		echo $previous
		;;
	allow)
		# Allow members of users group to change brightness
		gksudo chgrp naps62 ${path}/brightness
		gksudo chmod g+w ${path}/brightness
		;;
	disallow)
		# Disallow members of users group to change brightness
		gksudo chgrp root ${path}/brightness
		gksudo chmod g-w ${path}/brightness
		;;
	*)
		commit $1
esac

exit 0
